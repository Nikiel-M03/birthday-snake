<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday Ella!</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.0/p5.min.js"></script>
  </head>
  <body style="margin:0; overflow:hidden; background:#0a1428;">
    <script>
      let font;
      let pathPoints = [];
      let snake = [];
      let t = 0;
      const snakeLength = 80;
      let trailGraphics;

      function preload() {
        // Load a nice, legible font
        font = loadFont("https://cdnjs.cloudflare.com/ajax/libs/topcoat/0.8.0/font/SourceCodePro-Regular.otf");
      }

      function setup() {
        createCanvas(windowWidth, windowHeight);
        trailGraphics = createGraphics(windowWidth, windowHeight);
        trailGraphics.clear();

        textFont(font);
        textSize(min(windowWidth * 0.08, 100)); // scales font with screen size
        fill(255);

        const msg = "Happy Birthday Ella!";
        const msgWidth = textWidth(msg);
        const startX = (width - msgWidth) / 2;
        const startY = height / 2;

        // Create letter path
        pathPoints = font.textToPoints(msg, startX, startY, textSize(), {
          sampleFactor: 0.15,
          simplifyThreshold: 0
        });

        frameRate(60);
      }

      function draw() {
        background(10, 20, 40, 50);

        // Get position on the text path
        let idx = floor(t) % pathPoints.length;
        let pos = pathPoints[idx];
        snake.push({ x: pos.x, y: pos.y });

        if (snake.length > snakeLength) snake.shift();

        // Leave trail on separate graphics layer
        trailGraphics.noStroke();
        trailGraphics.fill(0, 255, 100, 150);
        trailGraphics.ellipse(pos.x, pos.y, 8, 8);

        // Draw the trail (so it stays!)
        image(trailGraphics, 0, 0);

        // Draw snake body
        noStroke();
        for (let i = 0; i < snake.length; i++) {
          let seg = snake[i];
          let sz = map(i, 0, snake.length, 8, 20);
          fill(lerpColor(color('#00ff88'), color('#00ffff'), i / snake.length));
          ellipse(seg.x, seg.y + sin(i * 0.3 + frameCount * 0.1) * 3, sz);
        }

        // Draw snake head glow
        let head = snake[snake.length - 1];
        if (head) {
          fill(255, 255, 150, 150);
          ellipse(head.x, head.y, 25);
        }

        // Slight shimmer / sparkles for a magical birthday vibe
        for (let i = 0; i < 5; i++) {
          stroke(255, 255, 200, 100);
          point(random(width), random(height));
        }

        noStroke();
        t += 0.6;

        // Keep the snake on screen by looping path
        if (t >= pathPoints.length) t = 0;
      }

      function windowResized() {
        resizeCanvas(windowWidth, windowHeight);
        trailGraphics = createGraphics(windowWidth, windowHeight);
        trailGraphics.clear();
        setup(); // Recalculate layout
      }
    </script>
  </body>
</html>
